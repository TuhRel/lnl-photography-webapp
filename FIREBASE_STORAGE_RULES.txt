// üîí Firebase Storage Security Rules for Photography Portfolio
// Copy and paste these rules into Firebase Console ‚Üí Storage ‚Üí Rules

rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    
    // üñºÔ∏è IMAGES FOLDER - Organized by content type
    match /images/{folder}/{imageId} {
      
      // PUBLIC READ ACCESS
      // All images can be viewed by anyone (for website display)
      allow read: if true;
      
      // ADMIN WRITE ACCESS
      // Only admins can upload, update, or delete images
      allow write: if isAdmin();
      
      // FILE VALIDATION
      // Ensure uploaded files are valid images under size limit
      allow write: if isAdmin() && 
                   isValidImage() && 
                   isValidSize();
    }
    
    // üîß HELPER FUNCTIONS
    
    // Check if user is admin
    function isAdmin() {
      return request.auth != null && 
             exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    // Validate image file type
    function isValidImage() {
      return resource == null || // Allow deletion
             request.resource.contentType.matches('image/.*');
    }
    
    // Validate file size (max 5MB)
    function isValidSize() {
      return resource == null || // Allow deletion
             request.resource.size <= 5 * 1024 * 1024;
    }
  }
}

// üìÅ FOLDER STRUCTURE:
// 
// images/
//   ‚îú‚îÄ‚îÄ hero/          - Hero section background images
//   ‚îú‚îÄ‚îÄ about/         - About page profile images  
//   ‚îú‚îÄ‚îÄ portfolio/     - Portfolio item images
//   ‚îú‚îÄ‚îÄ services/      - Service showcase images
//   ‚îî‚îÄ‚îÄ profiles/      - User profile pictures
//
// üîë PERMISSIONS:
// - Public: Can view all images (for website display)
// - Admins: Can upload/edit/delete images in any folder
// - File Types: Only image files allowed (image/*)
// - Size Limit: Maximum 5MB per file
//
// üöÄ TO APPLY THESE RULES:
// 1. Go to Firebase Console ‚Üí Storage ‚Üí Rules
// 2. Replace existing rules with the content above  
// 3. Click "Publish" to apply the changes
